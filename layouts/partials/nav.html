<nav class="fixed w-full bg-bg dark:bg-bg shadow-md z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

    <!-- NAV BAR -->
    <div class="flex flex-col lg:flex-row lg:justify-between lg:items-center py-4 lg:h-16">

      <!-- Logo -->
      <div class="flex justify-between items-center">
        <a href="{{ .Site.Home.RelPermalink }}"
           class="text-3xl font-bold text-text-primary dark:text-text-primary font-heading">
          {{ .Site.Params.name }}
        </a>
      </div>

      <!-- Navigation (ALWAYS VISIBLE ON MOBILE) -->
      <div class="mt-4 lg:mt-0 flex flex-col lg:flex-row lg:items-center lg:space-x-8 space-y-2 lg:space-y-0">

        {{ range .Site.Menus.main }}
          {{ if .HasChildren }}

            <!-- Parent -->
            <div class="relative group">
              <span class="nav-link text-text-primary dark:text-text-primary font-medium">
                {{ .Name }}
              </span>

              <!-- Children -->
              <div class="ml-4 lg:ml-0 lg:absolute lg:left-0 lg:top-full lg:mt-2
                          bg-bg dark:bg-bg lg:shadow-lg rounded-lg
                          lg:min-w-[10rem]
                          flex flex-col space-y-1
                          lg:opacity-0 lg:invisible group-hover:opacity-100 group-hover:visible">
                {{ range .Children }}
                  <a href="{{ .URL | relLangURL }}"
                     class="block px-3 py-1 text-sm text-text-primary dark:text-text-primary">
                    {{ .Name }}
                  </a>
                {{ end }}
              </div>
            </div>

          {{ else }}

            {{ if hasPrefix .URL "#" }}
            <a href="{{ printf "%s%s" $.Site.Home.RelPermalink .URL }}"
               class="nav-link section-link text-text-primary dark:text-text-primary"
               data-section="{{ .URL }}">
              {{ .Name }}
            </a>
            {{ else }}
            <a href="{{ .URL | relLangURL }}"
               class="nav-link text-text-primary dark:text-text-primary">
              {{ .Name }}
            </a>
            {{ end }}

          {{ end }}
        {{ end }}

        <!-- Language Switcher -->
        {{ $homes := $.Site.Home.AllTranslations }}
        {{ if gt (len $homes) 1 }}
        <div class="relative group mt-2 lg:mt-0">
          <span class="nav-link text-text-primary dark:text-text-primary cursor-pointer">
            üåê Language
          </span>
          <div class="ml-4 lg:ml-0 lg:absolute lg:right-0 lg:top-full lg:mt-2
                      bg-bg dark:bg-bg lg:shadow-lg rounded-lg
                      lg:min-w-[8rem]
                      flex flex-col
                      lg:opacity-0 lg:invisible group-hover:opacity-100 group-hover:visible">
            {{ range $homes }}
              <a href="{{ .RelPermalink }}"
                 class="block px-4 py-2 text-sm text-text-primary dark:text-text-primary {{ if eq .Language.Lang $.Site.Language.Lang }}font-semibold{{ end }}">
                {{ .Language.LanguageName }}
              </a>
            {{ end }}
          </div>
        </div>
        {{ end }}

        <!-- Social icons -->
        <div class="flex space-x-4 mt-4 lg:mt-0">
          {{ if .Site.Params.linkedin_url }}
          <a href="{{ .Site.Params.linkedin_url }}" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-linkedin-in text-xl"></i>
          </a>
          {{ end }}
          {{ if .Site.Params.github_url }}
          <a href="{{ .Site.Params.github_url }}" target="_blank" rel="noopener noreferrer">
            <i class="fab fa-github text-xl"></i>
          </a>
          {{ end }}
        </div>

      </div>
    </div>
  </div>

  <!-- Safety styles -->
  <style>
    nav {
      position: fixed;
      z-index: 99999;
    }

    /* Ensure background never blocks nav */
    .pexels-bg-container,
    .pexels-bg-container img,
    .pexels-overlay {
      pointer-events: none !important;
    }
  </style>
</nav>
